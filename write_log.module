<?php
/**
 * Implements hook_menu().
 */
function write_log_menu() {
  $items['write-log'] = array(
    'title' => 'Write log',
	'description' => 'Generated by write_log module.',
    'page callback' => 'drupal_get_form',
	'page arguments' => array('write_log_page_form'),
    'access callback' => TRUE,
	'menu_name' => 'main-menu',
	'type' => MENU_NORMAL_ITEM,
  );

  return $items;
}

/**
 * Page callback for /write-log.
 */
function write_log_page_form($form, &$form_state) {
  global $user;
  $form['message'] = array(
    '#type' => 'textarea', 
    '#title' => t('Message'), 
    '#default_value' => '', 
    '#size' => 60,  
    '#required' => TRUE,
  );
  
  $form['submit'] = array(
    '#type' => 'submit',
    '#value' => t('Send'),
	'#submit' => array('write_log_page_submit'),
  );


  if (user_is_anonymous()) {
    $form['name'] = array(
      '#type' => 'textfield', 
      '#title' => t('Name'), 
      '#default_value' => '', 
      '#size' => 60,  
      '#required' => TRUE,
    );
  }
  
  return $form;
}

/**
 * Implement message submit.
 */
function write_log_page_submit($form, &$form_state) {
  global $user;
  $wl_message = $form_state['values']['message'];
  watchdog('write_log', $wl_message . $user->name);
  drupal_set_message(t($user->name . '! Tanks for you log/message.'));

}